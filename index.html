<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®åœ‹åœ°æ”¿ã€æ˜“ä¸åœ°æ”¿ - æˆ¿è²¸æ™ºå›Šåœ˜</title>
    
    <!-- React & Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ç°¡æ˜“é˜²è­·èˆ‡æ¨£å¼ -->
    <style>
        body { -webkit-user-select: none; user-select: none; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        input, textarea, select { -webkit-user-select: text; user-select: text; }
        /* éš±è—æ»¾å‹•æ¢ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* æ‰‹æ©Ÿç‰ˆå„ªåŒ– */
        @media (max-width: 768px) {
            .mobile-nav-fix { padding-bottom: 80px; }
        }
    </style>
    
    <script>
        // ç°¡æ˜“é˜²è­·ï¼šç¦æ­¢å³éµèˆ‡F12
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.onkeydown = function(e) {
            if(e.keyCode == 123) { return false; } // F12
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)){ return false; } // Ctrl+Shift+I
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)){ return false; } // Ctrl+Shift+C
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)){ return false; } // Ctrl+Shift+J
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)){ return false; } // Ctrl+U
        }
    </script>
</head>
<body class="bg-gray-50 text-slate-800 h-screen overflow-hidden flex flex-col md:flex-row">

    <div id="root" class="w-full h-full flex flex-col md:flex-row"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- å…§å»ºåœ–ç¤ºå…ƒä»¶ ---
        const Icons = {
            Calculator: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>,
            BookOpen: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Settings: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            Save: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>,
            RotateCcw: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>,
            CheckCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            AlertCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>,
            Briefcase: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
            Home: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            DollarSign: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
            TrendingUp: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
            Unlock: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/></svg>,
            Users: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            FileText: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></svg>,
            ArrowDownCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><polyline points="8 12 12 16 16 12"/><line x1="12" x2="12" y1="8" y2="16"/></svg>,
            Menu: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
            X: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Building2: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>
        };

        const { 
            Calculator, BookOpen, Settings, Save, RotateCcw, 
            CheckCircle, AlertCircle, Briefcase, Home, DollarSign, 
            TrendingUp, Unlock, Users, FileText, ArrowDownCircle, 
            Menu, X, Building2
        } = Icons;

        // --- è³‡æ–™åº« ---
        const INITIAL_DATA = {
            selfEmployed: [
                { name: "å¯Œé‚¦", highlight: "çµ•å°ä¸çœ‹è–ªè³‡", rules: ["ç¨è³‡çœ‹401ï¼ŒæŠ“12%ç•¶æ‰€å¾—(7æˆ)", "èµ°è³‡ç”¢(8æˆ)ï¼šåŸºé‡‘ã€è‚¡ç¥¨ã€å„²è“„éšª", "åŸ·è¡Œæ¥­å‹™æ‰€å¾—(8æˆ)ï¼šçœ‹æ‰£é™¤æˆæœ¬å¾Œæ‰€å¾—ï¼Œç„¡åˆ—èˆ‰æ‰“7æŠ˜"] },
                { name: "äº¬åŸ", highlight: "åˆ†æœ‰/ç„¡çµ±ç·¨èªå®š", rules: ["æœ‰çµ±ç·¨(æ³•äºº)ï¼šçœ‹æç›Šè¡¨æ·¨åˆ©", "æœ‰çµ±ç·¨(è¡Œè™Ÿ)ï¼šçœ‹405è¡¨ç‡Ÿæ”¶", "ç„¡çµ±ç·¨(æ”¤è²©)ï¼šçœ‹å­˜æ‘ºå›ºå®šå…¥å¸³", "è³‡ç”¢åƒ…ä½œåƒè€ƒä¸åˆ—æ”¶æ”¯æ¯”"] },
                { name: "å°æ–°", highlight: "401/403/405çš†å¯", rules: ["æ­é…ç‡Ÿæ¥­åœ°ç¾å‹˜", "å…¬å¸å­˜æ¬¾æµé‡åŠé•·æœŸé¤˜é¡", "è‡ªç‡Ÿå•†ä¿äººå»ºè­°æ‰¾æœ‰ä¸€è¦ªç­‰è–ªè½‰è€…"] },
                { name: "å½°éŠ€", highlight: "è–ªè³‡å ±ç¨…ç‚ºä¸»", rules: ["æœ‰é™å…¬å¸çœ‹401ï¼Œåªèªæœªåˆ†é…ç›ˆé¤˜"] },
                { name: "è¯é‚¦", highlight: "è¡Œæ¥­æ·¨åˆ©ç‡æ¨ç®—", rules: ["401ç‡Ÿæ”¶*ä¸»è¨ˆè™•è¡Œæ¥­æ·¨åˆ©ç‡", "è®Šç›¸çœ‹è² è²¬äººè¿‘åŠå¹´å­˜æ‘ºå­˜å…¥é …", "è³‡ç”¢åƒ…ç•¶è²¡åŠ›è­‰æ˜"] },
                { name: "å‡±åŸº", highlight: "401ç‚ºä¸»ï¼Œè³‡ç”¢åŠ åˆ†", rules: ["ä»¥401å ±è¡¨è¨ˆç®—", "åŸºé‡‘è‚¡ç¥¨ä¿éšªç•¶åŠ åˆ†"] },
                { name: "ç‰å±±", highlight: "401ç‚ºä¸»", rules: ["æ·¨æ”¶å…¥å¤§éƒ¨åˆ†ä»¥2-3æˆç‚ºä¸»"] },
                { name: "å°ä¸­å•†éŠ€", highlight: "401æˆ–å…§å¸³", rules: ["åŸºé‡‘è‚¡ç¥¨ç‚ºæœ€å¾Œæ–¹æ³•ä¸”éœ€å¯©æŸ¥èªåŒ", "å€Ÿä¿æ—¥åˆä½µæ”¶å…¥èˆ‡è² å‚µ"] },
                { name: "æ–°å…‰", highlight: "æ”¶æ”¯æ¯”<65%", rules: ["çœ‹401è¡¨ï¼Œæœˆæ”¶å…¥å¯èªåˆ—", "æ”¶æ”¯æ¯”ç®—ä¸åˆ°æ‰æä¾›2ç­‰è¦ªä¿±è²¡åŠ›ä½œä¿"] },
                { name: "å°éŠ€", highlight: "è–ªè³‡->è³‡ç”¢è² å‚µ->å‡ºå…¥å¸³", rules: ["å„ªå…ˆçœ‹è–ªè³‡ï¼Œæ²’æœ‰å‰‡çœ‹è³‡ç”¢è² å‚µè¡¨ï¼Œå†æ²’æœ‰çœ‹å…¬å¸å‡ºå…¥å¸³", "401å¯è©•ä¼°"] },
                { name: "ä¸­ä¿¡", highlight: "è³‡ç”¢å…¨èªåˆ—", rules: ["æœ‰å ±ç¨…æ‰èªè–ªè³‡", "åŸºé‡‘/è‚¡ç¥¨/å„²è“„éšªå…¨èªåˆ—(è‡³å°‘è²¸æ¬¾é‡‘é¡1/3ä»¥ä¸Š)"] },
                { name: "é™½ä¿¡", highlight: "401+å­˜æ‘ºå­˜ç©", rules: ["ç†è²¡å•†å“å±¬åŠ åˆ†é …ç›®"] }
            ],
            renovation: [
                { name: "å¯Œé‚¦", terms: "20å¹´ / 2.8%èµ·", notes: "å¤šåŠ 0.5æˆï¼Œå¤šä¸€ç­†è¨­å®šï¼Œç®—åœ¨æˆ¿è²¸å…§" },
                { name: "ä¸­ä¿¡", terms: "10å¹´ / 3%èµ·", notes: "ç®—åœ¨æˆ¿è²¸å…§" },
                { name: "å‡±åŸº", terms: "15-20å¹´ / 2.6-3%", notes: "å¤šåŠ 0.5æˆï¼Œå¤šä¸€ç­†è¨­å®šï¼Œç®—åœ¨æˆ¿è²¸å…§" },
                { name: "æ°¸è±", terms: "15å¹´ / åˆ©ç‡+0.05-0.1%", notes: "ç„¡è£æ½¢è²¸åç›®ï¼Œä½µå…¥æˆ¿è²¸" }
            ],
            combo: [
                { name: "å…ƒå¤§", terms: "æœ€é«˜90% / ä¿¡è²¸æœ€é•·7å¹´", rate: "2.8%èµ·" },
                { name: "å°ä¸­å•†éŠ€", terms: "äºŒé †ä½ / ä¸ä½µå…¥æˆ¿è²¸ / æœ€é•·10å¹´", rate: "3.8-4%" },
                { name: "ç‹é“", terms: "äºŒé †ä½ / 8æˆå…§15å¹´ / è¶…é8æˆ10å¹´", rate: "4-8%", notes: "æœ€å¤š200è¬ï¼Œå¯åšäºŒé †ä½" },
                { name: "å¯Œé‚¦", terms: "æˆ¿è²¸+å¢è²¸æœ€é«˜85%", rate: "éœ€æœ‰è‡ªå‚™æ¬¾" }
            ],
            storefront: [
                { name: "å°ä¸­å•†éŠ€", ltv: "æœ€é«˜9æˆ", notes: "å„ªå‹¢" },
                { name: "ç‹é“", ltv: "å¹´é™20å¹´", notes: "å¯åšåº—é¢å‹ç”¢å“" },
                { name: "æ–°å…‰", ltv: "8-85æˆ", notes: "æ²’é™åˆ¶" },
                { name: "è¯å—", ltv: "å•†ç”¨7-75æˆ / ä½å•†8æˆ", notes: "" },
                { name: "ç‰å±±", ltv: "7-8æˆ", notes: "å•†æ•ˆä¸æ˜é¡¯æœ‰æ©Ÿæœƒ8æˆ" },
                { name: "æ°¸è±", ltv: "75æˆ", notes: "" },
                { name: "å¯Œé‚¦", ltv: "7-8æˆ", notes: "å¹´é™20å¹´" },
                { name: "å…¶ä»–", ltv: "6.5-7æˆ", notes: "å°éŠ€(6.5)ã€ä¸­ä¿¡(6.5)ã€è¯é‚¦(7)ã€å¯Œé‚¦äººå£½(7)ã€å‡±åŸº(7)ã€ä¸‰ä¿¡(7)" }
            ],
            cashRefinance: [
                { name: "æ°¸è±", ltv: "8æˆ", terms: "å¯é¦¬ä¸Šåš / 20-30å¹´ / 2.22-2.6%" },
                { name: "äº¬åŸ", ltv: "8æˆ", terms: "å¯é¦¬ä¸Šåš / 20å¹´ / 2.7-3.5%" },
                { name: "ä¸‰ä¿¡", ltv: "7æˆ", terms: "å¯é¦¬ä¸Šåš / 20å¹´ / 3.25%èµ·" },
                { name: "ç‹é“", ltv: "2.72%èµ·", terms: "è½‰å¢è²¸å°ˆæ¡ˆ", notes: "å¯¬é™æœŸæœ€å¤š2å¹´" },
                { name: "ä¸­ä¿¡", ltv: "85æˆ", terms: "è¦ç­‰1å¹´ / 30å¹´" },
                { name: "å‡±åŸº", ltv: "75-85æˆ", terms: "20å¹´ / 3%" },
                { name: "å…ƒå¤§", ltv: "8æˆ", terms: "ç­‰3å€‹æœˆ / 20-30å¹´" },
                { name: "å¯Œé‚¦", ltv: "8æˆ", terms: "ç­‰3å€‹æœˆ / 30å¹´ / 2.6-3.25%" },
                { name: "è¯é‚¦", ltv: "8æˆ", terms: "ç­‰6å€‹æœˆ / 20å¹´ / å—è´ˆå–å¾—ä¸å—å½±éŸ¿" },
                { name: "é æ±", ltv: "8æˆ", terms: "å–å¾—ä¸€å¹´ä¸¦ç¹³æ»¿åŠå¹´ / æ”¾äºŒé †ä½" },
                { name: "å°éŠ€", ltv: "7æˆ", terms: "20å¹´ / 2.985%èµ·" }
            ],
            noTieIn: [
                { name: "ä¸Šæµ·å•†éŠ€", rate: "3.8%èµ·", highlight: "æ–°åŠ å…¥" },
                { name: "è¯é‚¦", rate: "é¦–è³¼2.7-3% / ä¸ç¶ç´„3.2-3.5%" },
                { name: "å¯Œé‚¦", rate: "é¦–è³¼2.7-3% / ä¸ç¶ç´„3.7-4%" },
                { name: "ä¸‰ä¿¡", rate: "2.95%èµ·" },
                { name: "æ–°å…‰", rate: "2.88%èµ·" },
                { name: "å…¬è‚¡éŠ€è¡Œ", rate: "ä¾å„è¡Œè¦å®š" },
                { name: "äº¬åŸ", rate: "é¦–è³¼+0.5% (ç´„3.2%èµ·)" },
                { name: "å‡±åŸº", rate: "4%èµ·" }
            ],
            guarantor: [
                { name: "å½°éŠ€", rule: "å¯èªæœ€é«˜100%", calc: "å€Ÿæ¬¾äººèˆ‡ä¿äººéœ€åŠ è¨ˆåŸºæœ¬ç”Ÿæ´»é–‹éŠ·1.6è¬/æœˆ" },
                { name: "å°æ–°", rule: "æ”¶æ”¯æ¯”ä¸Šé™70%", calc: "åŠ è¨ˆæ¨ä¼°æ”¶å…¥å¾Œè¨ˆç®—" },
                { name: "äº¬åŸ", rule: "æ”¶æ”¯æ¯”ä¸Šé™70%", calc: "è‹¥å€Ÿæ¬¾äººä¸è¶³ï¼Œä¿äººéœ€è£œè¶³å·®é¡(ä¿äººæ”¶å…¥ - å€Ÿæ¬¾ç¼ºå£) / 0.7" },
                { name: "æ–°å…‰", rule: "æ”¶æ”¯æ¯”<65%", calc: "æ”¶å…¥/æœˆç¹³(å«è² å‚µ)" },
                { name: "å°ä¸­å•†éŠ€", rule: "æ”¶æ”¯æ¯”>100%", calc: "å€Ÿä¿äººæ”¶æ”¯åˆä½µè¨ˆç®—" },
                { name: "è¯é‚¦", rule: "æ”¶æ”¯æ¯”70%", calc: "ä¿äººè² å‚µéœ€ä¸€ä½µè¨ˆç®—ï¼Œé™è¦ªå±¬" },
                { name: "è¯å—", rule: "ç´šè·å¼", calc: "åˆè¨ˆæœˆæ”¶2è¬è²¸200è¬ï¼Œ3è¬è²¸300è¬..." }
            ]
        };

        const DEBT_OPTIONS = ['æˆ¿è²¸', 'è»Šè²¸', 'ä¿¡è²¸', 'å­¸è²¸', 'ä¼æ¥­è²¸'];
        const ASSET_OPTIONS = ['ç„¡æˆ¿å±‹', 'ä¸€é–“æˆ¿å±‹', 'äºŒé–“æˆ¿å±‹', 'ä¸‰é–“æˆ¿å±‹å«ä»¥ä¸Š'];

        // --- ä¸»ç¨‹å¼ ---
        function App() {
            const [activeTab, setActiveTab] = useState('assessment');
            const [bankData, setBankData] = useState(INITIAL_DATA);
            const [importText, setImportText] = useState('');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

            const [formData, setFormData] = useState({
                price: 1800,
                loanAmount: 1440, 
                job: 'è‡ªç”±æ¥­',
                age: 30,
                monthlyIncome: 20,
                annualIncome: 240, 
                assets: 'ç„¡æˆ¿å±‹',
                debts: [], 
                debtAmount: 30,
                creditCard: 'æœ‰ä½¿ç”¨ï¼Œå…¨é¡ç¹³æ¸…',
                propertyType: 'ä½å®¶',
                purpose: 'è³¼å±‹',
                needsRenovation: false,
                needsNoTieIn: false,
                needsCashFlow: false
            });

            // åˆå§‹åŒ–èˆ‡ LocalStorage
            useEffect(() => {
                const savedData = localStorage.getItem('mortgageBankData_PRO');
                if (savedData) {
                    setBankData(JSON.parse(savedData));
                }
            }, []);

            const handleSaveData = () => {
                localStorage.setItem('mortgageBankData_PRO', JSON.stringify(bankData));
                alert('è³‡æ–™åº«å·²æ›´æ–°ï¼');
            };

            const handleResetData = () => {
                if(window.confirm('ç¢ºå®šè¦é‡ç½®å›é è¨­è³‡æ–™å—ï¼Ÿ')) {
                    setBankData(INITIAL_DATA);
                    localStorage.removeItem('mortgageBankData_PRO');
                }
            };

            // è¼¸å…¥è™•ç† & é€£å‹•è¨ˆç®—
            const handleInputChange = (e) => {
                const { name, value, type, checked } = e.target;
                
                if (name === 'price') {
                    const priceVal = parseFloat(value) || 0;
                    setFormData(prev => ({
                        ...prev,
                        price: value,
                        loanAmount: Math.round(priceVal * 0.8) // é è¨­8æˆ
                    }));
                } else if (name === 'monthlyIncome') {
                    const monthlyVal = parseFloat(value) || 0;
                    setFormData(prev => ({
                        ...prev,
                        monthlyIncome: value,
                        annualIncome: Math.round(monthlyVal * 12) // é è¨­12å€
                    }));
                } else {
                    setFormData(prev => ({
                        ...prev,
                        [name]: type === 'checkbox' ? checked : value
                    }));
                }
            };

            const toggleDebt = (debtType) => {
                setFormData(prev => {
                    const exists = prev.debts.includes(debtType);
                    if (exists) {
                        return { ...prev, debts: prev.debts.filter(d => d !== debtType) };
                    } else {
                        return { ...prev, debts: [...prev.debts, debtType] };
                    }
                });
            };

            // æ™ºæ…§è§£æ
            const handleParseText = () => {
                if(!importText.trim()) return;

                let newForm = { ...formData };
                newForm.debts = []; // é‡ç½®è² å‚µ
                
                const text = importText;

                // è¼”åŠ©å‡½å¼ï¼šæ”¯æ´ã€ŒLabel: Valueã€æˆ–ã€ŒQn... \n A: Valueã€æ ¼å¼
                const extract = (regex) => {
                    const match = text.match(regex);
                    return match ? match[1].trim() : null;
                };

                // é‡å° Q&A æ ¼å¼çš„æŠ½å–å™¨
                const extractQA = (qNum) => {
                    // å°‹æ‰¾ Q(æ•¸å­—)... æ›è¡Œ A(å†’è™Ÿ)... çš„æ¨¡å¼
                    const regex = new RegExp(`Q${qNum}[^\\n]*\\n+A[ï¼š:]\\s*(.*)`);
                    const match = text.match(regex);
                    return match ? match[1].trim() : null;
                };

                // --- 1. åƒ¹æ ¼ ---
                // å„ªå…ˆæŠ“å–ä¸Šæ–¹ç¸½è¡¨ï¼Œè‹¥ç„¡å‰‡æŠ“ Q&A (é›–ç„¶é€šå¸¸åƒ¹æ ¼åœ¨æœ€ä¸Šé¢)
                let priceRaw = extract(/[é æˆ][è¨ˆäº¤]åƒ¹æ ¼[ï¼š:]\s*([\d,]+)/);
                if(priceRaw) {
                    let p = parseFloat(priceRaw.replace(/,/g, ''));
                    // å–®ä½åˆ¤æ–·ï¼šè‹¥å¤§æ–¼ 10000 (å¦‚ 13,900,000)ï¼Œè‡ªå‹•é™¤ä»¥ä¸€è¬
                    if (p > 10000) p = p / 10000;
                    newForm.price = p;
                    newForm.loanAmount = Math.round(p * 0.8);
                }

                // --- 2. æ¬²è²¸é‡‘é¡ ---
                let loanRaw = extract(/[æ¬²è²¸]è²¸æ¬¾é‡‘é¡[ï¼š:]\s*([\d,]*)/); // å¯èƒ½ç‚ºç©º
                if(loanRaw && loanRaw.trim() !== '') {
                    let l = parseFloat(loanRaw.replace(/,/g, ''));
                    if (l > 10000) l = l / 10000;
                    newForm.loanAmount = l;
                }

                // --- 3. è·æ¥­ (Q1) ---
                const jobRaw = extractQA(1);
                if(jobRaw) {
                    if(jobRaw.includes('å•†') || jobRaw.includes('è‡ªç‡Ÿ') || jobRaw.includes('è€é—†') || jobRaw.includes('è² è²¬äºº')) {
                        newForm.job = 'å…¬å¸è² è²¬äºº'; // æˆ–è‡ªç”±æ¥­ï¼Œè¦–ç‚ºè‡ªç‡Ÿå•†é¡åˆ¥
                    } else if (jobRaw.includes('è‡ªç”±') || jobRaw.includes('SOHO')) {
                        newForm.job = 'è‡ªç”±æ¥­';
                    } else if (jobRaw.includes('å®¶ç®¡')) {
                        newForm.job = 'å®¶ç®¡';
                    } else {
                        newForm.job = 'ä¸€èˆ¬ä¸Šç­æ—';
                    }
                }

                // --- 4. å¹´é½¡ (Q2) ---
                const ageRaw = extractQA(2);
                if(ageRaw) {
                    const ageMatch = ageRaw.match(/(\d+)/);
                    if(ageMatch) newForm.age = ageMatch[1];
                }

                // --- 5. æœˆæ”¶ (Q3) ---
                const monthlyRaw = extractQA(3);
                if(monthlyRaw) {
                    // è™•ç†ç¯„åœ "6-7è¬" -> å–å¹³å‡ 6.5
                    const rangeMatch = monthlyRaw.match(/(\d+)[\-~](\d+)/);
                    if(rangeMatch) {
                        const avg = (parseFloat(rangeMatch[1]) + parseFloat(rangeMatch[2])) / 2;
                        newForm.monthlyIncome = avg;
                    } else {
                        const singleMatch = monthlyRaw.match(/(\d+)/);
                        if(singleMatch) newForm.monthlyIncome = parseFloat(singleMatch[1]);
                    }
                }

                // --- 6. å¹´æ”¶ (Q5) ---
                const annualRaw = extractQA(5);
                if(annualRaw) {
                     const rangeMatch = annualRaw.match(/(\d+)[\-~](\d+)/);
                    if(rangeMatch) {
                        const avg = (parseFloat(rangeMatch[1]) + parseFloat(rangeMatch[2])) / 2;
                        newForm.annualIncome = avg;
                    } else {
                        // ç§»é™¤ NTD, comma
                        const cleanStr = annualRaw.replace(/,/g, '');
                        const singleMatch = cleanStr.match(/(\d+)/);
                        if(singleMatch) {
                            let y = parseFloat(singleMatch[1]);
                            // åˆ¤æ–·æ˜¯å¦ç‚ºå…ƒå–®ä½ (å¦‚ 1,200,000)
                            if (y > 10000) y = y / 10000;
                            newForm.annualIncome = y;
                        }
                    }
                } else if (newForm.monthlyIncome) {
                    // è‹¥ Q5 æ²’æŠ“åˆ°ï¼Œç”¨æœˆæ”¶æ¨ç®—
                    newForm.annualIncome = newForm.monthlyIncome * 12;
                }

                // --- 7. è² å‚µ (Q6 & Q7) ---
                const debtQ6 = extractQA(6);
                const debtQ7 = extractQA(7);
                const debtStr = (debtQ6 || '') + (debtQ7 || '');
                
                if (debtStr.includes('ç„¡') || debtStr.includes('æ²’æœ‰')) {
                    newForm.debts = [];
                    newForm.debtAmount = 0;
                } else {
                     DEBT_OPTIONS.forEach(opt => {
                        if(debtStr.includes(opt)) {
                            if(!newForm.debts.includes(opt)) newForm.debts.push(opt);
                        }
                    });
                    // å˜—è©¦å¾ Q7 æŠ“é‡‘é¡
                    const amountMatch = debtStr.match(/(\d+)è¬/);
                    if(amountMatch) newForm.debtAmount = parseFloat(amountMatch[1]);
                }

                // --- 8. ä¿¡ç”¨å¡ (Q8) ---
                const ccRaw = extractQA(8);
                if(ccRaw) newForm.creditCard = ccRaw;

                setFormData(newForm);
                alert('æ™ºæ…§è§£ææˆåŠŸï¼å·²è‡ªå‹•æ›ç®—å–®ä½èˆ‡è¨ˆç®—å¹³å‡æ”¶å…¥ã€‚');
            };

            // PMT è¨ˆç®— (æœ¬æ¯æ”¤é‚„)
            const calculateMonthlyPayment = () => {
                if (!formData.loanAmount || formData.loanAmount <= 0) return 0;
                // å‡è¨­å¹´åˆ©ç‡ 2.2%, 30å¹´ (360æœŸ)
                const principal = formData.loanAmount * 10000; // è½‰ç‚ºå…ƒ
                const annualRate = 0.022;
                const monthlyRate = annualRate / 12;
                const months = 360;

                // PMT = P * r * (1+r)^n / ((1+r)^n - 1)
                const pmt = principal * monthlyRate * Math.pow(1 + monthlyRate, months) / (Math.pow(1 + monthlyRate, months) - 1);
                
                // è½‰ç‚º "è¬" é¡¯ç¤º
                return (pmt / 10000).toFixed(2);
            };

            // æ¨è–¦é‚è¼¯
            const recommendations = useMemo(() => {
                let recs = [];
                const { job, propertyType, needsRenovation, purpose, needsNoTieIn } = formData;

                if (job === 'è‡ªç”±æ¥­' || job === 'è‡ªç‡Ÿå•†' || job === 'è€é—†' || job === 'å…¬å¸è² è²¬äºº') {
                    recs.push({
                        type: 'è‡ªç‡Ÿå•†å„ªå‹¢',
                        banks: bankData.selfEmployed,
                        reason: 'é‡å°è‡ªç‡Ÿå•†/è‡ªç”±æ¥­ï¼Œä¸åŒéŠ€è¡Œæœ‰ä¸åŒçš„æ”¶å…¥èªå®šæ¨™æº–ã€‚'
                    });
                }

                if (propertyType === 'åº—é¢') {
                    recs.push({
                        type: 'åº—é¢é«˜æˆæ•¸',
                        banks: bankData.storefront.filter(b => b.ltv && (b.ltv.includes('8') || b.ltv.includes('9') || b.name === 'ç‹é“' || b.name === 'å°ä¸­å•†éŠ€')),
                        reason: 'åº—é¢ç”¢å“è²¸æ¬¾æˆæ•¸é€šå¸¸è¼ƒä½ï¼Œä»¥ä¸‹éŠ€è¡Œæä¾›è¼ƒé«˜æˆæ•¸æˆ–å°ˆæ¡ˆã€‚'
                    });
                }

                if (needsRenovation) {
                    recs.push({
                        type: 'è£æ½¢è²¸æ¬¾',
                        banks: bankData.renovation,
                        reason: 'å¯æ­é…æˆ¿è²¸ç”³è«‹è£æ½¢é‡‘ï¼Œéœ€æ³¨æ„å¹´é™èˆ‡åˆ©ç‡å·®ç•°ã€‚'
                    });
                }

                if (purpose === 'è½‰å¢è²¸' || purpose === 'ç¾é‡‘è²·å›è²¸') {
                    recs.push({
                        type: 'ç¾é‡‘è³¼è²·å†å¢è²¸ / äºŒèƒ',
                        banks: bankData.cashRefinance.concat(bankData.combo.filter(b => b.name === 'ç‹é“' || b.name === 'å°ä¸­å•†éŠ€')), // åˆä½µé¡¯ç¤º
                        reason: 'æ³¨æ„ã€Œç­‰å¾…æœŸã€é™åˆ¶ï¼Œéƒ¨åˆ†éŠ€è¡Œéœ€æŒæœ‰æ»¿ä¸€å¹´æˆ–ä¸‰å€‹æœˆã€‚'
                    });
                }

                if (needsNoTieIn) {
                    recs.push({
                        type: 'ä¸ç¶ç´„æ–¹æ¡ˆ',
                        banks: bankData.noTieIn,
                        reason: 'é©åˆçŸ­æœŸæŒæœ‰æˆ–æ‰“ç®—å¿«é€Ÿæ¸…å„Ÿè€…ï¼Œä½†åˆ©ç‡é€šå¸¸è¼ƒé«˜ã€‚'
                    });
                }

                return recs;
            }, [formData, bankData]);

            const generateCopyText = () => {
                const text = `ã€æˆ¿è²¸åˆæ­¥è©•ä¼°è³‡æ–™ã€‘\n\nğŸ”†é è¨ˆæˆäº¤åƒ¹æ ¼ï¼š${formData.price}è¬\nğŸ”…æ¬²è²¸æ¬¾é‡‘é¡ï¼š${formData.loanAmount}è¬\n\nQ1è·æ¥­ï¼š${formData.job}\nQ2å¹´é½¡ï¼š${formData.age}æ­²\nQ3æœˆæ”¶ï¼š${formData.monthlyIncome}è¬\nQ4å¹´æ”¶ï¼š${formData.annualIncome}è¬\nQ5è³‡ç”¢ï¼š${formData.assets}\n\nã€è² å‚µç‹€æ³ã€‘\nQ7è²¸æ¬¾é …ç›®ï¼š${formData.debts.join('ã€') || 'ç„¡'}\nQ8è² å‚µæ˜ç´°ï¼š${formData.debtAmount}è¬\nQ9ä¿¡ç”¨å¡ï¼š${formData.creditCard}\nQ10æ¡ˆä»¶é¡å‹ï¼š${formData.propertyType} / ${formData.purpose}\n${formData.needsRenovation ? '(å«è£æ½¢éœ€æ±‚)' : ''}\n${formData.needsNoTieIn ? '(å¸Œæœ›ä¸ç¶ç´„)' : ''}\n`;
                navigator.clipboard.writeText(text);
                alert('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            };

            // UI Components
            const NavButton = ({ tab, icon: Icon, label }) => (
                <button 
                    onClick={() => { setActiveTab(tab); setIsMobileMenuOpen(false); }}
                    className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full text-left ${activeTab === tab ? 'bg-yellow-500 text-slate-900 font-bold' : 'hover:bg-slate-700 text-gray-300'}`}
                >
                    <Icon size={20} />
                    {label}
                </button>
            );

            return (
                <>
                    {/* Sidebar / Mobile Menu */}
                    <aside className={`bg-slate-800 text-white flex-shrink-0 z-50 transition-all duration-300
                        ${isMobileMenuOpen ? 'fixed inset-0 overflow-y-auto' : 'hidden md:block md:w-64 md:relative'}
                    `}>
                        <div className="p-6 border-b border-slate-700 flex justify-between items-center">
                            <div>
                                <h1 className="text-xl font-bold flex items-center gap-2">
                                    <Building2 className="w-6 h-6 text-yellow-400" />
                                    <div className="flex flex-col">
                                        <span className="text-base leading-tight">å®åœ‹åœ°æ”¿ã€æ˜“ä¸åœ°æ”¿</span>
                                        <span className="text-xs text-yellow-400 font-normal">æˆ¿è²¸æ™ºå›Šåœ˜ Pro</span>
                                    </div>
                                </h1>
                            </div>
                            <button onClick={() => setIsMobileMenuOpen(false)} className="md:hidden">
                                <X size={24} />
                            </button>
                        </div>
                        <nav className="p-4 space-y-2">
                            <NavButton tab="assessment" icon={Calculator} label="æ¡ˆä»¶è©•ä¼°" />
                            <NavButton tab="knowledge" icon={BookOpen} label="éŠ€è¡Œæ–¹æ¡ˆå¤§å…¨" />
                            <NavButton tab="settings" icon={Settings} label="è³‡æ–™åº«ç®¡ç†" />
                        </nav>
                        <div className="p-6 mt-auto hidden md:block">
                            <div className="bg-slate-700 rounded p-3 text-xs text-slate-300">
                                <p>ç³»çµ±ç‰ˆæœ¬ï¼šv3.2</p>
                                <p>Q&A æ™ºæ…§è§£æï¼šå•Ÿç”¨</p>
                            </div>
                        </div>
                    </aside>

                    {/* Mobile Header (When sidebar hidden) */}
                    <div className="md:hidden bg-slate-800 text-white p-4 flex justify-between items-center shadow-lg sticky top-0 z-40">
                         <h1 className="font-bold flex items-center gap-2">
                            <Building2 className="w-5 h-5 text-yellow-400" />
                            å®åœ‹ã€æ˜“ä¸åœ°æ”¿
                        </h1>
                        <button onClick={() => setIsMobileMenuOpen(true)}>
                            <Menu size={24} />
                        </button>
                    </div>

                    {/* Main Content */}
                    <main className="flex-1 overflow-y-auto p-4 md:p-8 bg-gray-50 mobile-nav-fix">
                        {/* Tab: Assessment */}
                        {activeTab === 'assessment' && (
                            <div className="max-w-6xl mx-auto space-y-6">
                                <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                                    <h2 className="text-2xl font-bold text-slate-800">å®¢æˆ¶æ¡ˆä»¶è©•ä¼° (KYC)</h2>
                                    <button onClick={generateCopyText} className="bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded flex items-center gap-2 text-sm shadow">
                                        <CheckCircle size={18} /> åŒ¯å‡ºçµæœæ–‡å­—
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                    {/* è¼¸å…¥å€ */}
                                    <div className="lg:col-span-1 space-y-4">
                                        {/* æ™ºæ…§åŒ¯å…¥ */}
                                        <div className="bg-blue-50 p-4 rounded-xl border border-blue-200 shadow-sm">
                                            <h3 className="text-sm font-bold text-blue-800 mb-2 flex items-center gap-2">
                                                <FileText size={16}/> æ™ºæ…§åŒ¯å…¥ (è²¼ä¸Šå®¢æˆ¶å›å‚³è³‡æ–™)
                                            </h3>
                                            <textarea 
                                                className="w-full p-2 text-xs border border-blue-200 rounded h-24 focus:ring-2 focus:ring-blue-400 mb-2"
                                                placeholder="åœ¨æ­¤è²¼ä¸Šå®¢æˆ¶å›å‚³çš„æ–‡å­—..."
                                                value={importText}
                                                onChange={(e) => setImportText(e.target.value)}
                                            />
                                            <button 
                                                onClick={handleParseText}
                                                className="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-sm font-bold flex justify-center items-center gap-2 shadow"
                                            >
                                                <ArrowDownCircle size={16} /> è§£æä¸¦å¡«å…¥è¡¨å–®
                                            </button>
                                        </div>

                                        {/* è¡¨å–® */}
                                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                            <h3 className="text-lg font-bold mb-4 border-b pb-2 flex items-center gap-2">
                                                <Users size={18} /> å®¢æˆ¶åŸºæœ¬è³‡æ–™
                                            </h3>
                                            <div className="space-y-4 text-sm">
                                                <div>
                                                    <label className="block text-gray-600 mb-1 font-bold">è·æ¥­é¡åˆ¥</label>
                                                    <select name="job" value={formData.job} onChange={handleInputChange} className="w-full p-2 border rounded bg-gray-50 focus:ring-blue-500">
                                                        <option value="ä¸€èˆ¬ä¸Šç­æ—">ä¸€èˆ¬ä¸Šç­æ—</option>
                                                        <option value="è‡ªç”±æ¥­">è‡ªç”±æ¥­/è‡ªç‡Ÿå•†</option>
                                                        <option value="å…¬å¸è² è²¬äºº">å…¬å¸è² è²¬äºº</option>
                                                        <option value="å®¶ç®¡">å®¶ç®¡</option>
                                                    </select>
                                                </div>
                                                <div className="grid grid-cols-2 gap-2">
                                                    <div>
                                                        <label className="block text-gray-600 mb-1 font-bold">æˆäº¤åƒ¹ (è¬)</label>
                                                        <input type="number" name="price" value={formData.price} onChange={handleInputChange} className="w-full p-2 border rounded focus:ring-blue-500" />
                                                    </div>
                                                    <div>
                                                        <label className="block text-gray-600 mb-1 font-bold">æ¬²è²¸é‡‘é¡ (è¬)</label>
                                                        <input type="number" name="loanAmount" value={formData.loanAmount} onChange={handleInputChange} className="w-full p-2 border rounded focus:ring-blue-500 bg-yellow-50" />
                                                    </div>
                                                </div>
                                                <div className="grid grid-cols-2 gap-2">
                                                    <div>
                                                         <label className="block text-gray-600 mb-1 font-bold">æœˆæ”¶ (è¬)</label>
                                                         <input type="number" name="monthlyIncome" value={formData.monthlyIncome} onChange={handleInputChange} className="w-full p-2 border rounded focus:ring-blue-500" />
                                                    </div>
                                                    <div>
                                                         <label className="block text-gray-600 mb-1 font-bold">å¹´æ”¶ (è¬)</label>
                                                         <input type="number" name="annualIncome" value={formData.annualIncome} onChange={handleInputChange} className="w-full p-2 border rounded focus:ring-blue-500 bg-yellow-50" />
                                                    </div>
                                                </div>
                                                <div>
                                                    <label className="block text-gray-600 mb-1 font-bold">è³‡ç”¢ç‹€æ³</label>
                                                    <select name="assets" value={formData.assets} onChange={handleInputChange} className="w-full p-2 border rounded bg-gray-50">
                                                        {ASSET_OPTIONS.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                                    </select>
                                                </div>
                                                <div>
                                                    <label className="block text-gray-600 mb-1 font-bold">è² å‚µé …ç›®</label>
                                                    <div className="flex flex-wrap gap-2">
                                                        {DEBT_OPTIONS.map(opt => (
                                                            <button
                                                                key={opt}
                                                                onClick={() => toggleDebt(opt)}
                                                                className={`px-2 py-1 rounded text-xs border transition-colors ${
                                                                    formData.debts.includes(opt) 
                                                                    ? 'bg-red-100 border-red-300 text-red-700 font-bold' 
                                                                    : 'bg-gray-50 border-gray-200 text-gray-500 hover:bg-gray-100'
                                                                }`}
                                                            >
                                                                {opt}
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>
                                                <div>
                                                    <label className="block text-gray-600 mb-1 font-bold">è² å‚µç¸½é¡ (è¬)</label>
                                                    <input type="number" name="debtAmount" value={formData.debtAmount} onChange={handleInputChange} className="w-full p-2 border rounded" />
                                                </div>
                                                
                                                <div className="border-t pt-4 mt-4">
                                                    <h4 className="font-bold mb-2">ç‰¹æ®Šéœ€æ±‚èˆ‡ç”¢å“</h4>
                                                    <div className="space-y-3">
                                                        <div className="flex items-center justify-between">
                                                            <label>ç”¢å“é¡å‹</label>
                                                            <select name="propertyType" value={formData.propertyType} onChange={handleInputChange} className="p-1 border rounded bg-gray-50 w-32">
                                                                <option value="ä½å®¶">ä½å®¶</option>
                                                                <option value="åº—é¢">åº—é¢/å•†ç”¨</option>
                                                                <option value="é€å¤©">é€å¤©</option>
                                                            </select>
                                                        </div>
                                                        <div className="flex items-center justify-between">
                                                            <label>è³‡é‡‘ç”¨é€”</label>
                                                            <select name="purpose" value={formData.purpose} onChange={handleInputChange} className="p-1 border rounded bg-gray-50 w-32">
                                                                <option value="è³¼å±‹">ä¸€èˆ¬è³¼å±‹</option>
                                                                <option value="è½‰å¢è²¸">è½‰å¢è²¸</option>
                                                                <option value="ç¾é‡‘è²·å›è²¸">ç¾é‡‘è²·å¾Œè²¸æ¬¾</option>
                                                            </select>
                                                        </div>
                                                        <label className="flex items-center gap-3 cursor-pointer bg-slate-50 p-2 rounded hover:bg-slate-100 transition">
                                                            <input type="checkbox" name="needsRenovation" checked={formData.needsRenovation} onChange={handleInputChange} className="w-4 h-4" />
                                                            <span className="text-sm">éœ€è¦è£æ½¢è²¸æ¬¾</span>
                                                        </label>
                                                        <label className="flex items-center gap-3 cursor-pointer bg-slate-50 p-2 rounded hover:bg-slate-100 transition">
                                                            <input type="checkbox" name="needsNoTieIn" checked={formData.needsNoTieIn} onChange={handleInputChange} className="w-4 h-4" />
                                                            <span className="text-sm">å¸Œæœ›ä¸ç¶ç´„</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* åˆ†æçµæœ */}
                                    <div className="lg:col-span-2 space-y-6">
                                        
                                        {/* å„€è¡¨æ¿ */}
                                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                            <h3 className="text-lg font-bold mb-4 flex items-center gap-2 text-blue-800">
                                                <TrendingUp size={20} /> åˆæ­¥è²¡å‹™æ¯”ç‡ (Pro)
                                            </h3>
                                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div className="bg-blue-50 p-4 rounded-lg">
                                                    <p className="text-xs text-blue-600 font-bold uppercase">LTV è²¸æ¬¾æˆæ•¸</p>
                                                    <p className="text-2xl font-bold text-blue-900">
                                                        {formData.price > 0 ? ((formData.loanAmount / formData.price) * 100).toFixed(1) : 0}%
                                                    </p>
                                                    <p className="text-xs text-blue-500 mt-1">å»ºè­°æ§åˆ¶åœ¨ 80% å…§</p>
                                                </div>
                                                <div className="bg-green-50 p-4 rounded-lg">
                                                    <p className="text-xs text-green-600 font-bold uppercase">DBR æ”¶æ”¯æ¯”ä¼°ç®—</p>
                                                    <p className="text-2xl font-bold text-green-900">
                                                        {formData.monthlyIncome > 0 
                                                            ? Math.round(((calculateMonthlyPayment() * 10000 + (formData.debtAmount * 0.02 * 10000 || 0)) / (formData.monthlyIncome * 10000)) * 100)
                                                            : 0}%
                                                    </p>
                                                    <p className="text-xs text-green-500 mt-1">å«æˆ¿è²¸+è² å‚µ(ä¼°2%)<br/>(åˆ†å­/æœˆæ”¶)</p>
                                                </div>
                                                <div className="bg-purple-50 p-4 rounded-lg">
                                                    <p className="text-xs text-purple-600 font-bold uppercase">æœ¬æ¯æ”¤é‚„è©¦ç®—</p>
                                                    <p className="text-2xl font-bold text-purple-900">
                                                        {calculateMonthlyPayment()} <span className="text-sm">è¬/æœˆ</span>
                                                    </p>
                                                    <p className="text-xs text-purple-500 mt-1">åˆ©ç‡2.2% / 30å¹´</p>
                                                </div>
                                            </div>
                                            <div className="text-right mt-2 text-xs text-gray-400">
                                                * æ‚¨å°‡è©¦ç®—é‚è¼¯å‡ç´šç‚ºæ›´ç²¾æº–çš„ã€Œæœ¬æ¯æ”¤é‚„ã€æ¨¡å‹
                                            </div>
                                        </div>

                                        {/* æ¨è–¦åˆ—è¡¨ */}
                                        <div>
                                            <h3 className="text-lg font-bold mb-4 flex items-center gap-2">
                                                <CheckCircle size={20} className="text-green-600" /> 
                                                é©åˆéŠ€è¡Œæ¨è–¦ç­–ç•¥
                                            </h3>
                                            
                                            {recommendations.length === 0 ? (
                                                <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200 text-center text-gray-500">
                                                    <p className="text-lg mb-2">ğŸ§ ç›®å‰æ¢ä»¶ç‚ºä¸€èˆ¬æ¨™æº–æ¡ˆä»¶</p>
                                                    <p className="text-sm">å»ºè­°å„ªå…ˆè©¢å•è–ªè½‰éŠ€è¡Œæˆ–ä¸»åŠ›å¾€ä¾†éŠ€è¡Œï¼Œæˆ–è‡³ã€ŒéŠ€è¡Œæ–¹æ¡ˆå¤§å…¨ã€æŸ¥çœ‹æ›´å¤šè³‡è¨Šã€‚</p>
                                                </div>
                                            ) : (
                                                <div className="space-y-6">
                                                    {recommendations.map((rec, idx) => (
                                                        <div key={idx} className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                                            <div className="bg-slate-50 p-3 border-b border-gray-100 flex justify-between items-center">
                                                                <span className="font-bold text-slate-700 flex items-center gap-2">
                                                                    <Unlock size={16} /> {rec.type}
                                                                </span>
                                                                <span className="text-xs text-slate-500">{rec.reason}</span>
                                                            </div>
                                                            <div className="p-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                                                {rec.banks.map((bank, bIdx) => (
                                                                    <div key={bIdx} className="bg-yellow-50/50 p-3 rounded border border-yellow-100 hover:bg-yellow-50 transition-colors">
                                                                        <div className="flex justify-between items-start mb-1">
                                                                            <span className="font-bold text-blue-800 text-base">{bank.name}</span>
                                                                            <div className="flex gap-1">
                                                                                {bank.highlight && <span className="bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full">{bank.highlight}</span>}
                                                                                {bank.ltv && <span className="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full">{bank.ltv}</span>}
                                                                            </div>
                                                                        </div>
                                                                        <div className="text-sm text-gray-600 space-y-1 mt-2">
                                                                            {bank.rules && bank.rules.map((r, i) => <li key={i} className="list-none text-xs flex gap-1 before:content-['â€¢']">{r}</li>)}
                                                                            {bank.terms && <p className="text-xs font-medium bg-white/50 p-1 rounded inline-block">æ¢ä»¶ï¼š{bank.terms}</p>}
                                                                            {bank.notes && <p className="text-xs text-gray-500 mt-1">{bank.notes}</p>}
                                                                            {bank.rate && <p className="text-xs text-red-500 font-bold mt-1">åˆ©ç‡ï¼š{bank.rate}</p>}
                                                                        </div>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Tab: Knowledge */}
                        {activeTab === 'knowledge' && (
                            <div className="max-w-4xl mx-auto space-y-8">
                                <h2 className="text-2xl font-bold text-slate-800 border-b pb-4">éŠ€è¡Œæ–¹æ¡ˆçŸ¥è­˜åº«</h2>
                                
                                <section>
                                    <h3 className="text-xl font-bold text-blue-700 mb-4 flex items-center gap-2">
                                        <Briefcase /> è‡ªç‡Ÿå•†/è² è²¬äºº æ”¶å…¥èªå®š
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {bankData.selfEmployed.map((bank, idx) => (
                                            <div key={idx} className="bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
                                                <div className="flex justify-between items-center mb-2">
                                                    <span className="font-bold text-lg">{bank.name}</span>
                                                    <span className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">{bank.highlight}</span>
                                                </div>
                                                <ul className="list-disc pl-5 text-sm text-gray-600 space-y-1">
                                                    {bank.rules.map((rule, rIdx) => <li key={rIdx}>{rule}</li>)}
                                                </ul>
                                            </div>
                                        ))}
                                    </div>
                                </section>

                                <section>
                                    <h3 className="text-xl font-bold text-purple-700 mb-4 flex items-center gap-2">
                                        <Users /> ä¿è­‰äººæ”¶æ”¯è¨ˆç®—é‚è¼¯
                                    </h3>
                                    <div className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                                        <table className="w-full text-sm text-left">
                                            <thead className="bg-purple-50 text-purple-900">
                                                <tr>
                                                    <th className="p-3">éŠ€è¡Œ</th>
                                                    <th className="p-3">æ”¶æ”¯æ¯”è¦ç¯„</th>
                                                    <th className="p-3 hidden md:table-cell">è¨ˆç®—ç´°ç¯€</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-100">
                                                {bankData.guarantor.map((g, idx) => (
                                                    <tr key={idx}>
                                                        <td className="p-3 font-bold">{g.name}</td>
                                                        <td className="p-3">{g.rule}</td>
                                                        <td className="p-3 text-gray-600 block md:table-cell text-xs md:text-sm">{g.calc}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </section>

                                <section>
                                    <h3 className="text-xl font-bold text-green-700 mb-4 flex items-center gap-2">
                                        <Home /> åº—é¢ã€äºŒèƒèˆ‡è£æ½¢
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <h4 className="font-bold mb-2 bg-slate-100 p-2 rounded">åº—é¢ç”¢å“ (æˆæ•¸)</h4>
                                            <ul className="bg-white p-4 rounded-lg shadow-sm border border-gray-200 space-y-2 text-sm">
                                                {bankData.storefront.map((s, i) => (
                                                    <li key={i} className="flex justify-between border-b border-gray-50 last:border-0 pb-1">
                                                        <span className="font-bold">{s.name}</span>
                                                        <span>{s.ltv} <span className="text-gray-400 text-xs">({s.notes})</span></span>
                                                    </li>
                                                ))}
                                            </ul>
                                        </div>
                                        <div>
                                             <h4 className="font-bold mb-2 bg-slate-100 p-2 rounded">äºŒèƒ / è½‰å¢è²¸å°ˆæ¡ˆ</h4>
                                             <ul className="bg-white p-4 rounded-lg shadow-sm border border-gray-200 space-y-2 text-sm">
                                                {bankData.combo.concat(bankData.cashRefinance.filter(x=>x.name==='ç‹é“')).map((s, i) => (
                                                    <li key={i} className="border-b border-gray-50 last:border-0 pb-2">
                                                        <div className="flex justify-between font-bold">
                                                            <span>{s.name}</span>
                                                            <span className="text-blue-600">{s.rate || s.terms}</span>
                                                        </div>
                                                        <div className="text-xs text-gray-500 mt-1">{s.notes || s.terms}</div>
                                                    </li>
                                                ))}
                                             </ul>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        )}

                        {/* Tab: Settings */}
                        {activeTab === 'settings' && (
                            <div className="max-w-3xl mx-auto">
                                <h2 className="text-2xl font-bold text-slate-800 mb-6">è³‡æ–™åº«ç®¡ç†</h2>
                                <div className="bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-6 text-sm text-yellow-800 flex items-start gap-2">
                                    <AlertCircle size={20} className="shrink-0" />
                                    <div>
                                        <p className="font-bold">æ³¨æ„ï¼š</p>
                                        <p>æ­¤è™•å…è¨±ç·¨è¼¯ç³»çµ±é‚è¼¯ã€‚ä¿®æ”¹å¾Œè«‹æŒ‰ã€Œå„²å­˜ã€ï¼Œè³‡æ–™å°‡ä¿å­˜åœ¨æ­¤è¨­å‚™çš„ç€è¦½å™¨ä¸­ã€‚</p>
                                    </div>
                                </div>
                                
                                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
                                    <label className="block mb-2 font-bold text-gray-700">è³‡æ–™åº«åŸå§‹ç¢¼ (JSON)</label>
                                    <textarea 
                                        className="w-full h-96 font-mono text-sm p-4 border rounded bg-slate-50 focus:ring-2 focus:ring-blue-500"
                                        value={JSON.stringify(bankData, null, 2)}
                                        onChange={(e) => {
                                            try {
                                                const newData = JSON.parse(e.target.value);
                                                setBankData(newData);
                                            } catch(err) {}
                                        }}
                                    />
                                </div>

                                <div className="flex gap-4 mt-6">
                                    <button onClick={handleSaveData} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-bold shadow">
                                        <Save size={20} /> å„²å­˜è®Šæ›´
                                    </button>
                                    <button onClick={handleResetData} className="flex items-center gap-2 bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-bold">
                                        <RotateCcw size={20} /> é‡ç½®å›é è¨­å€¼
                                    </button>
                                </div>
                            </div>
                        )}
                    </main>
                </>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>